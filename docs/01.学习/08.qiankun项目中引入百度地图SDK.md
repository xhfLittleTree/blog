---
title: qiankun项目中引入百度地图SDK
date: 2024-04-09 13:37:00
permalink: /pages/20240409133700/
categories: 
  - 学习
tags: 
  - null
---

## 背景介绍

项目使用qiankun框架，当引入百度地图SDK时，会遇到跨域的问题

## 详细情况

首先使用动态方式去引入百度地图SDK

```js
  let key = `${申请的key}`
  let script = document.createElement("script"); 
  script.src = `https://api.map.baidu.com/api?v=1.0&type=webgl&ak=${key}`;
  document.getElementsByTagName('HEAD')[0].appendChild(script)

```
发现跨域问题

因为qiankun对子应用加载的资源会进行一层代理

可以在start方法的参数中增加excludeAssetFilter参数来指定部分特殊的动态加载的微应用资源（css/js) 不被 qiankun 劫持处理。

```js
  start({
    excludeAssetFilter: (assetUrl) => {
      const whiteList = []
      //  百度地图相关资源过滤
      const whiteWords = ['api.map.baidu', 'dlswbr.baidu.com','maponline0.bdimg.com']
      if (whiteList.includes(assetUrl)) {
          return true
      }
      return whiteWords.some((w) => {
      return assetUrl.includes(w)
      })
    }
  });
```
此时，我们动态加载的baidu地图相关的资源就不会被qiankun所劫持了。




